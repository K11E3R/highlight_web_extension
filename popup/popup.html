<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Highlighter</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="app">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="brand">
          <div class="brand-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 19l7-7 3 3-7 7-3-3z"/>
              <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/>
            </svg>
          </div>
        </div>
      </div>
      
      <nav class="sidebar-nav">
        <button id="viewPageBtn" class="nav-item active" data-tooltip="This Page" title="This Page" aria-label="View this page highlights">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
          </svg>
        </button>
        <button id="viewAllBtn" class="nav-item" data-tooltip="All Pages" title="All Pages" aria-label="View all highlights">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="7" height="7"/>
            <rect x="14" y="3" width="7" height="7"/>
            <rect x="14" y="14" width="7" height="7"/>
            <rect x="3" y="14" width="7" height="7"/>
          </svg>
        </button>
        
        <div class="nav-divider"></div>
        
        <button id="ribbonToggle" class="nav-item" data-tooltip="Quick Mode" title="Quick Mode" aria-label="Toggle quick mode">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
          </svg>
        </button>
        <button id="manageCategoriesBtn" class="nav-item" data-tooltip="Categories" title="Categories" aria-label="Manage categories">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"/>
            <line x1="7" y1="7" x2="7.01" y2="7"/>
          </svg>
        </button>
      </nav>
      
      <div class="sidebar-footer">
        <button id="exportBtn" class="nav-item" data-tooltip="Export" title="Export" aria-label="Export highlights">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="7 10 12 15 17 10"/>
            <line x1="12" y1="15" x2="12" y2="3"/>
          </svg>
        </button>
        <button id="importBtn" class="nav-item" data-tooltip="Import" title="Import" aria-label="Import highlights">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="17 8 12 3 7 8"/>
            <line x1="12" y1="3" x2="12" y2="15"/>
          </svg>
        </button>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="content">
      <!-- Top Bar -->
      <header class="topbar">
        <div class="topbar-title">
          <h1 id="viewTitle">This Page</h1>
          <span class="badge" id="countBadge">0</span>
        </div>
        <button id="refreshBtn" class="btn-refresh" title="Refresh">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="23 4 23 10 17 10"/>
            <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>
          </svg>
        </button>
      </header>

      <!-- PDF Banner -->
      <div id="pdfBanner" class="pdf-banner hidden">
        <div class="pdf-banner-icon">ðŸ“„</div>
        <div class="pdf-banner-text">
          <strong>PDF detected</strong>
          <span>Open in viewer to highlight</span>
        </div>
        <button id="openPdfViewer" class="pdf-banner-action">Open Viewer</button>
      </div>

      <!-- Filters -->
      <div class="filters">
        <div class="color-pills" id="colorFilterContainer">
          <button class="color-pill active" data-color="all" title="All colors" aria-label="All colors">
            <span class="color-pill-dot all"></span>
            All
          </button>
          <button class="color-pill" data-color="yellow" title="Yellow" aria-label="Yellow highlights">
            <span class="color-pill-dot yellow"></span>
          </button>
          <button class="color-pill" data-color="green" title="Green" aria-label="Green highlights">
            <span class="color-pill-dot green"></span>
          </button>
          <button class="color-pill" data-color="blue" title="Blue" aria-label="Blue highlights">
            <span class="color-pill-dot blue"></span>
          </button>
          <button class="color-pill" data-color="purple" title="Purple" aria-label="Purple highlights">
            <span class="color-pill-dot purple"></span>
          </button>
          <button class="color-pill" data-color="pink" title="Pink" aria-label="Pink highlights">
            <span class="color-pill-dot pink"></span>
          </button>
        </div>
        
        <div class="category-tabs" id="categoryChips">
          <button class="category-tab active" data-category="all">All</button>
        </div>
      </div>

      <!-- Highlights -->
      <div class="highlights-wrapper">
        <div id="highlightsList" class="highlights">
          <!-- Empty State -->
          <div id="emptyState" class="empty">
            <div class="empty-visual">
              <div class="empty-circle"></div>
              <svg class="empty-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M12 19l7-7 3 3-7 7-3-3z"/>
                <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/>
              </svg>
            </div>
            <h3 class="empty-title">No highlights yet</h3>
            <p class="empty-desc">Select text on any page to highlight</p>
          </div>
        </div>
      </div>

      <!-- Footer Actions -->
      <footer class="footer">
        <button id="clearAllBtn" class="btn-clear" disabled>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="3 6 5 6 21 6"/>
            <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
          </svg>
          Clear all
        </button>
      </footer>
    </main>
  </div>

  <!-- Ribbon Indicator -->
  <div class="ribbon-toast" id="ribbonIndicator">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/>
    </svg>
    Quick Mode Active
  </div>

  <!-- Toast -->
  <div id="toast" class="toast hidden"></div>

  <!-- Modals -->
  <!-- Category Modal -->
  <div id="categoryModal" class="modal hidden">
    <div class="modal-overlay"></div>
    <div class="modal-panel">
      <header class="modal-header">
        <h2>Manage Categories</h2>
        <button id="closeCategoryModal" class="modal-close" title="Close" aria-label="Close modal">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </header>
      <div class="modal-content">
        <div class="input-row">
          <input type="text" id="newCategoryInput" placeholder="New category name..." maxlength="30" aria-label="Category name">
          <button id="addCategoryBtn" class="btn-add">Add</button>
        </div>
        <ul id="categoryList" class="category-list"></ul>
      </div>
    </div>
  </div>

  <!-- Export Modal -->
  <div id="exportModal" class="modal hidden">
    <div class="modal-overlay"></div>
    <div class="modal-panel">
      <header class="modal-header">
        <h2>Export</h2>
        <button id="closeExportModal" class="modal-close" title="Close" aria-label="Close modal">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </header>
      <div class="modal-content">
        <p class="modal-desc">Choose categories to export:</p>
        <div id="exportCategoryList" class="checkbox-group"></div>
        <div class="modal-actions">
          <button id="cancelExportBtn" class="btn-secondary">Cancel</button>
          <button id="confirmExportBtn" class="btn-primary">Download JSON</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Import Modal -->
  <div id="importModal" class="modal hidden">
    <div class="modal-overlay"></div>
    <div class="modal-panel">
      <header class="modal-header">
        <h2>Import</h2>
        <button id="closeImportModal" class="modal-close" title="Close" aria-label="Close modal">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </header>
      <div class="modal-content">
        <div class="import-preview">
          <div class="import-preview-row">
            <span class="import-label">File</span>
            <span id="importFileName" class="import-value">-</span>
          </div>
          <div class="import-preview-row">
            <span class="import-label">Items</span>
            <span id="importHighlightCount" class="import-value">-</span>
          </div>
          <div class="import-preview-row">
            <span class="import-label">Exported</span>
            <span id="importExportDate" class="import-value">-</span>
          </div>
        </div>
        <label class="select-label">
          Assign to category
          <select id="importCategorySelect" class="select">
            <option value="">Keep original</option>
            <option value="uncategorized">Uncategorized</option>
          </select>
        </label>
        <div class="modal-actions">
          <button id="cancelImportBtn" class="btn-secondary">Cancel</button>
          <button id="confirmImportBtn" class="btn-primary">Import</button>
        </div>
      </div>
    </div>
  </div>

  <input type="file" id="importFileInput" accept=".json" class="hidden" aria-label="Import JSON file">

  <script src="ribbons.js"></script>
  <script src="splashCursor.js"></script>
  <script src="popup.js" type="module"></script>
</body>
</html>
